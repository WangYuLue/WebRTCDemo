<div id="container">
    <!-- <video></video> -->
</div>
<script src="./js/simplepeer.min.js"></script>
<script src="./js/socket.io.js"></script>
<script>
    var Peer = SimplePeer ;
    var peers = {} ;

    var socket = io('http://localhost:8999',{
        path:'/manage'
    });

    // socket.on('create',function(){
    //     console.log("create message")
    //     create();
    // })
   

    function start(){
        socket.emit("start")
    }

    socket.on('reply',function(data){
        create();
    })
    

    function create (stream) {
        var peer = new Peer()

        peer.on('signal', function (data) {
            socket.emit('message',data)
           // peer2.signal(data)
        })

        socket.on('message',function(data){
            console.log('message',data);
            peer.signal(data)
        })

        peer.on('stream', function (stream) {
            console.log(stream)
            var video = document.createElement('video');
            // got remote video stream, now let's show it in a video tag
            //var video = document.querySelector('video')
            video.srcObject = stream;
            document.getElementById('container').appendChild(video);
            video.play()
        })

        peer.on('connect', function (e) {
            console.log("can connect",e)
        })
        peer.on('close', function (e) {
            console.log("connection close",e)
        })
        peers[peer._id] = peer;
    }
</script>